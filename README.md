# NASentinel

## 概述
NASentinel 是一套專為 Synology NAS 設計的日誌查詢與管理工具，具備強大的圖形化介面，能協助管理員安全、快速地查詢、統計並匯出各類日誌與排行榜，提升資訊稽核與管理效率。

---

## 主要功能特色

- **NAS API 客戶端整合**  
  內建 `NASClient`，可與 Synology NAS API 直接互動，支援登入、日誌查詢、用戶資訊查詢等功能。
- **雙重驗證支援**  
  登入流程支援雙重驗證碼（OTP），符合現代資安需求。
- **多種日誌查詢與匯出**  
  支援系統日誌、檔案管理日誌（FileStation）、用戶操作排行榜等查詢，並可一鍵匯出為格式化 Excel 檔案。
- **排行榜自動統計**  
  自動統計用戶上傳、下載、刪除等操作次數，生成專屬排行榜。
- **日期區間查詢**  
  內建直覺式日期選擇器，可自訂查詢區間。
- **批次處理與操作日誌**  
  批量查詢與匯出，並記錄每次操作結果，便於追蹤與問題排查。
- **現代化 GUI**  
  採用 PyQt5 打造，操作直覺、介面美觀。

---

## 系統需求

- Python 3.8 或更高版本
- 依賴套件：
  - `requests`
  - `tenacity`
  - `PyQt5`
  - `pandas`
  - `openpyxl`

---

## 安裝與執行

1. 下載並解壓縮專案檔案。
2. 進入 `/dist/NASentinel` 目錄，複製 `NASentinel.exe` 路徑。
3. 建議於桌面建立捷徑，雙擊即可執行。

---

## 操作流程

1. **登入 NAS**  
   - 輸入 NAS IP（如 `10.57.78.62`）、埠口（如 `5000`）、管理員帳號、密碼與雙重驗證碼（如有）。
   - 點擊「登入」進入主介面。
2. **日誌查詢與匯出**  
   - 選擇查詢類型（系統日誌、檔案管理日誌、排行榜）。
   - 設定查詢日期區間。
   - 點擊查詢，結果將顯示於表格中。
   - 點擊「匯出」即可將結果儲存至桌面。
3. **排行榜功能**  
   - 自動彙整各用戶上傳、下載、刪除操作次數，生成排行榜並支援匯出。
4. **日期選擇器**  
   - 透過滑鼠、鍵盤或滾輪選擇開始與結束日期，靈活篩選日誌。

---

## Excel 匯出格式

### 系統日誌（System Log）
- 檔案名稱：`NAS_System_Log_YYYY-MM-DD-HH_MM_SS.xlsx`
- 欄位：優先層級｜日誌｜時間｜使用者｜事件

### 檔案管理日誌（FileStation Log）
- 檔案名稱：`NAS_Filestation_Log_YYYY-MM-DD-HH_MM_SS.xlsx`
- 欄位：日誌｜時間｜IP位址｜使用者｜事件｜檔案/資料夾｜檔案大小｜檔案名稱

### 排行榜日誌（Ranking Log）
- 檔案名稱：`NAS_Ranking_Log_YYYY-MM-DD-HH_MM_SS.xlsx`
- 工作表：上傳排行榜、下載排行榜、刪除排行榜
- 欄位：排名｜使用者｜次數｜姓名｜電子郵件

---

## 程式架構與核心模組

- `main.py`：主程式，負責 GUI 及流程控制
- `api.py`：NAS API 互動與錯誤處理
- `system_log.py`：系統日誌處理與匯出
- `filestation_log.py`：檔案管理日誌處理與匯出
- `ranking_log.py`：排行榜資料統計與匯出
- `date_picker.py`：日期選擇器元件
- `utils.py`：常用工具（如日期格式化、視窗置中）

---

## 常見錯誤處理

- 登入失敗（帳號/密碼/OTP 錯誤、權限不足等）會顯示明確錯誤訊息。
- 查詢過程如遇 API 連線問題，會自動重試並提示用戶。
- 匯出時若資料不完整或格式錯誤，會彈窗提示。

---

## 聯絡與支援

作者：余浩維  
Email：haoweiyu0926@gmail.com

如有問題或建議，歡迎來信指教！
